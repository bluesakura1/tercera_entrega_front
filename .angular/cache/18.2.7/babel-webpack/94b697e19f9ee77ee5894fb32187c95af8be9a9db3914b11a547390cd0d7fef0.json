{"ast":null,"code":"import { Validators, ReactiveFormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../../services/supabase/booking.service\";\nimport * as i3 from \"@angular/router\";\nexport let BookingComponent = /*#__PURE__*/(() => {\n  class BookingComponent {\n    fb;\n    bookingService;\n    route;\n    router;\n    booking = [];\n    actualuser = JSON.parse(localStorage.getItem('user'));\n    bookingForm;\n    propertyId = '';\n    constructor(fb, bookingService, route, router) {\n      this.fb = fb;\n      this.bookingService = bookingService;\n      this.route = route;\n      this.router = router;\n      // Definir el formulario con los controles necesarios\n      this.bookingForm = this.fb.group({\n        listingId: ['', [Validators.required, Validators.pattern(/^\\d+$/)]],\n        startDate: ['', Validators.required],\n        endDate: ['', Validators.required],\n        totalPrice: ['', [Validators.required, Validators.min(0)]]\n      });\n    }\n    ngOnInit() {\n      // Obtener el ID de la propiedad desde la URL\n      this.propertyId = this.route.snapshot.paramMap.get('id') || '';\n    }\n    // Método para realizar la reserva\n    onSubmit() {\n      if (this.bookingForm.valid) {\n        // Obtener las fechas como cadenas en formato YYYY-MM-DD\n        const startDate = this.bookingForm.value.startDate;\n        const endDate = this.bookingForm.value.endDate;\n        // Validar que las fechas no sean inválidas\n        if (!startDate || !endDate) {\n          console.error('Las fechas de inicio o fin son inválidas');\n          return;\n        }\n        //aqui establecmos un precio pr defecto para proba\n        const totalPrice = this.bookingForm.value.totalPrice || 56437;\n        // Obtener el user_id del localStorage (asegúrate que el usuario esté autenticado)\n        const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\n        const userId = currentUser?.user_id;\n        // Validar que se obtuvo el user_id\n        if (!userId) {\n          console.error('No se pudo obtener el user_id del usuario');\n          return;\n        }\n        // Preparar los datos de la reserva, asegurándose de que las fechas estén en formato correcto\n        const bookingData = {\n          listing_id: parseInt(this.bookingForm.value.listingId, 10),\n          user_id: userId,\n          start_date: startDate,\n          end_date: endDate,\n          total_price: totalPrice\n        };\n        // Llamar al servicio para realizar la reserva\n        this.bookingService.realizarReserva(bookingData).subscribe(response => {\n          console.log('Reserva realizada con éxito', response);\n          this.router.navigate(['/property-list']);\n        }, error => {\n          console.error('Error al realizar la reserva', error);\n          if (error.error && error.error.message) {\n            console.error('Errores específicos:', error.error.message);\n          }\n        });\n      } else {\n        console.error('Formulario inválido');\n      }\n    }\n    // Método para cancelar una reserva\n    cancelarReserva(bookingId) {\n      this.bookingService.cancelarReserva(bookingId).subscribe(response => {\n        console.log('Reserva cancelada', response);\n      }, error => {\n        console.error('Error al cancelar la reserva', error);\n      });\n    }\n    submitget() {\n      this.bookingService.obtenerReservasBuyer(this.actualuser.user_id).subscribe(response => {\n        console.log('Reserva cancelada', response);\n        this.booking.push(response);\n      }, error => {\n        console.error('Error al cancelar la reserva', error);\n      });\n    }\n    print(reu) {\n      console.log(reu);\n    }\n    ObtenerReserva(bookingId) {\n      console.log(\"w\");\n    }\n    static ɵfac = function BookingComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || BookingComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.BookingService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BookingComponent,\n      selectors: [[\"app-booking\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 35,\n      vars: 0,\n      consts: [[1, \"main-container\"], [1, \"reservations-container\"], [1, \"reservations-list\"], [1, \"reservation-item\"], [1, \"reservation-details\"], [1, \"reservation-actions\"], [1, \"btn\"], [1, \"form-container\"], [\"for\", \"name\"], [\"type\", \"text\", \"id\", \"name\", \"name\", \"name\", \"placeholder\", \"Introduce tu nombre\"], [\"for\", \"email\"], [\"type\", \"email\", \"id\", \"email\", \"name\", \"email\", \"placeholder\", \"Introduce tu email\"], [\"type\", \"submit\", 1, \"btn-primary\"], [1, \"regresar\"], [\"href\", \"#\"]],\n      template: function BookingComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"body\")(1, \"div\", 0)(2, \"div\", 1)(3, \"h1\");\n          i0.ɵɵtext(4, \"Reservas\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"ul\", 2)(6, \"li\", 3)(7, \"div\", 4)(8, \"p\");\n          i0.ɵɵtext(9, \"Reserva 1\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(10, \"div\", 5)(11, \"button\", 6);\n          i0.ɵɵtext(12, \"Eliminar\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(13, \"li\", 3)(14, \"div\", 4)(15, \"p\");\n          i0.ɵɵtext(16, \"Reserva 2\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"div\", 5)(18, \"button\", 6);\n          i0.ɵɵtext(19, \"Eliminar\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(20, \"div\", 7)(21, \"h2\");\n          i0.ɵɵtext(22, \"Formulario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"form\")(24, \"label\", 8);\n          i0.ɵɵtext(25, \"Nombre\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"input\", 9);\n          i0.ɵɵelementStart(27, \"label\", 10);\n          i0.ɵɵtext(28, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(29, \"input\", 11);\n          i0.ɵɵelementStart(30, \"button\", 12);\n          i0.ɵɵtext(31, \"Enviar\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(32, \"div\", 13)(33, \"a\", 14);\n          i0.ɵɵtext(34, \"Regresar\");\n          i0.ɵɵelementEnd()()()()()();\n        }\n      },\n      dependencies: [ReactiveFormsModule, i1.ɵNgNoValidate, i1.NgControlStatusGroup, CommonModule],\n      styles: [\"body[_ngcontent-%COMP%] {\\n  background: #244623;\\n  font-family: Arial, sans-serif;\\n  margin: 0;\\n  padding: 0;\\n  color: #fff;\\n}\\n\\n.main-container[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: row; \\n\\n  justify-content: space-between;\\n  gap: 20px;\\n  padding: 25px;\\n  max-width: 1200px;\\n  margin: auto;\\n}\\n\\n.reservations-container[_ngcontent-%COMP%], \\n.form-container[_ngcontent-%COMP%] {\\n  flex: 1;\\n  background: #218a50;\\n  border: 30px solid #28533a;\\n  border-radius: 10px;\\n  padding: 20px;\\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);\\n  display: flex;\\n  flex-direction: column; \\n\\n}\\n\\n.reservations-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], \\n.form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  color: #af2323;\\n  font-size: 1.8rem;\\n  text-align: center;\\n  margin-bottom: 20px;\\n  border-bottom: 2px solid #0c0c0c;\\n  display: inline-block;\\n  padding-bottom: 5px;\\n}\\n\\n.reservations-list[_ngcontent-%COMP%] {\\n  list-style: none;\\n  padding: 0;\\n}\\n\\n.reservation-item[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  background: #30a9be;\\n  border: 3px solid #000;\\n  border-radius: 20px;\\n  margin: 10px 0;\\n  padding: 15px;\\n  box-shadow: 0 4px 6px green;\\n  transition: transform 0.5s, box-shadow 0.2s;\\n  cursor: pointer;\\n}\\n\\n.reservation-item[_ngcontent-%COMP%]:hover {\\n  transform: scale(1.11);\\n  box-shadow: 0 2px 1px green;\\n}\\n\\n.reservation-details[_ngcontent-%COMP%] {\\n  text-align: left;\\n  color: #000;\\n}\\n\\n.reservation-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\\n  padding: 10px 15px;\\n  border: none;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  font-weight: bold;\\n  background: #cc0101;\\n  color: white;\\n  transition: background 0.2s;\\n}\\n\\n.reservation-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover {\\n  background: #3b7440;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n  display: block;\\n  margin-bottom: 5px;\\n  color: #000;\\n  font-weight: bold;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 10px;\\n  margin-bottom: 15px;\\n  border: 3px solid #000000;\\n  border-radius: 5px;\\n  box-sizing: border-box;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%] {\\n  padding: 10px 15px;\\n  border: none;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  font-weight: bold;\\n  background: #cc0101;\\n  color: white;\\n  transition: background 0.2s;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled {\\n  background: #ccc;\\n  cursor: not-allowed;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:enabled {\\n  background: #1c7432;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   .regresar[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\n  color: #fff;\\n  text-decoration: none;\\n}\\n\\n.form-container[_ngcontent-%COMP%]   .regresar[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\\n  text-decoration: underline;\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvcGFnZXMvYm9va2luZy9ib29raW5nLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxtQkFBbUI7RUFDbkIsOEJBQThCO0VBQzlCLFNBQVM7RUFDVCxVQUFVO0VBQ1YsV0FBVztBQUNiOztBQUVBO0VBQ0UsYUFBYTtFQUNiLG1CQUFtQixFQUFFLHNDQUFzQztFQUMzRCw4QkFBOEI7RUFDOUIsU0FBUztFQUNULGFBQWE7RUFDYixpQkFBaUI7RUFDakIsWUFBWTtBQUNkOztBQUVBOztFQUVFLE9BQU87RUFDUCxtQkFBbUI7RUFDbkIsMEJBQTBCO0VBQzFCLG1CQUFtQjtFQUNuQixhQUFhO0VBQ2IseUNBQXlDO0VBQ3pDLGFBQWE7RUFDYixzQkFBc0IsRUFBRSw4REFBOEQ7QUFDeEY7O0FBRUE7O0VBRUUsY0FBYztFQUNkLGlCQUFpQjtFQUNqQixrQkFBa0I7RUFDbEIsbUJBQW1CO0VBQ25CLGdDQUFnQztFQUNoQyxxQkFBcUI7RUFDckIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFVBQVU7QUFDWjs7QUFFQTtFQUNFLGFBQWE7RUFDYiw4QkFBOEI7RUFDOUIsbUJBQW1CO0VBQ25CLG1CQUFtQjtFQUNuQixzQkFBc0I7RUFDdEIsbUJBQW1CO0VBQ25CLGNBQWM7RUFDZCxhQUFhO0VBQ2IsMkJBQTJCO0VBQzNCLDJDQUEyQztFQUMzQyxlQUFlO0FBQ2pCOztBQUVBO0VBQ0Usc0JBQXNCO0VBQ3RCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLG1CQUFtQjtFQUNuQixZQUFZO0VBQ1osMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsV0FBVztFQUNYLGFBQWE7RUFDYixtQkFBbUI7RUFDbkIseUJBQXlCO0VBQ3pCLGtCQUFrQjtFQUNsQixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLG1CQUFtQjtFQUNuQixZQUFZO0VBQ1osMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSwwQkFBMEI7QUFDNUIiLCJzb3VyY2VzQ29udGVudCI6WyJib2R5IHtcclxuICBiYWNrZ3JvdW5kOiAjMjQ0NjIzO1xyXG4gIGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjtcclxuICBtYXJnaW46IDA7XHJcbiAgcGFkZGluZzogMDtcclxuICBjb2xvcjogI2ZmZjtcclxufVxyXG5cclxuLm1haW4tY29udGFpbmVyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7IC8qIENhbWJpYWRvIGEgZGlzcG9zaWNpw4PCs24gaG9yaXpvbnRhbCAqL1xyXG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICBnYXA6IDIwcHg7XHJcbiAgcGFkZGluZzogMjVweDtcclxuICBtYXgtd2lkdGg6IDEyMDBweDtcclxuICBtYXJnaW46IGF1dG87XHJcbn1cclxuXHJcbi5yZXNlcnZhdGlvbnMtY29udGFpbmVyLFxyXG4uZm9ybS1jb250YWluZXIge1xyXG4gIGZsZXg6IDE7XHJcbiAgYmFja2dyb3VuZDogIzIxOGE1MDtcclxuICBib3JkZXI6IDMwcHggc29saWQgIzI4NTMzYTtcclxuICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG4gIHBhZGRpbmc6IDIwcHg7XHJcbiAgYm94LXNoYWRvdzogMCA4cHggMTZweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyAvKiBBc2VndXJhIHF1ZSBlbCBjb250ZW5pZG8gaW50ZXJubyBlc3TDg8KpIGFsaW5lYWRvIGVuIGNvbHVtbmEgKi9cclxufVxyXG5cclxuLnJlc2VydmF0aW9ucy1jb250YWluZXIgaDEsXHJcbi5mb3JtLWNvbnRhaW5lciBoMiB7XHJcbiAgY29sb3I6ICNhZjIzMjM7XHJcbiAgZm9udC1zaXplOiAxLjhyZW07XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcbiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkICMwYzBjMGM7XHJcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gIHBhZGRpbmctYm90dG9tOiA1cHg7XHJcbn1cclxuXHJcbi5yZXNlcnZhdGlvbnMtbGlzdCB7XHJcbiAgbGlzdC1zdHlsZTogbm9uZTtcclxuICBwYWRkaW5nOiAwO1xyXG59XHJcblxyXG4ucmVzZXJ2YXRpb24taXRlbSB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBiYWNrZ3JvdW5kOiAjMzBhOWJlO1xyXG4gIGJvcmRlcjogM3B4IHNvbGlkICMwMDA7XHJcbiAgYm9yZGVyLXJhZGl1czogMjBweDtcclxuICBtYXJnaW46IDEwcHggMDtcclxuICBwYWRkaW5nOiAxNXB4O1xyXG4gIGJveC1zaGFkb3c6IDAgNHB4IDZweCBncmVlbjtcclxuICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC41cywgYm94LXNoYWRvdyAwLjJzO1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxufVxyXG5cclxuLnJlc2VydmF0aW9uLWl0ZW06aG92ZXIge1xyXG4gIHRyYW5zZm9ybTogc2NhbGUoMS4xMSk7XHJcbiAgYm94LXNoYWRvdzogMCAycHggMXB4IGdyZWVuO1xyXG59XHJcblxyXG4ucmVzZXJ2YXRpb24tZGV0YWlscyB7XHJcbiAgdGV4dC1hbGlnbjogbGVmdDtcclxuICBjb2xvcjogIzAwMDtcclxufVxyXG5cclxuLnJlc2VydmF0aW9uLWFjdGlvbnMgLmJ0biB7XHJcbiAgcGFkZGluZzogMTBweCAxNXB4O1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gIGJhY2tncm91bmQ6ICNjYzAxMDE7XHJcbiAgY29sb3I6IHdoaXRlO1xyXG4gIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4ycztcclxufVxyXG5cclxuLnJlc2VydmF0aW9uLWFjdGlvbnMgLmJ0bjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZDogIzNiNzQ0MDtcclxufVxyXG5cclxuLmZvcm0tY29udGFpbmVyIGxhYmVsIHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBtYXJnaW4tYm90dG9tOiA1cHg7XHJcbiAgY29sb3I6ICMwMDA7XHJcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn1cclxuXHJcbi5mb3JtLWNvbnRhaW5lciBpbnB1dCB7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgcGFkZGluZzogMTBweDtcclxuICBtYXJnaW4tYm90dG9tOiAxNXB4O1xyXG4gIGJvcmRlcjogM3B4IHNvbGlkICMwMDAwMDA7XHJcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XHJcbn1cclxuXHJcbi5mb3JtLWNvbnRhaW5lciAuYnRuLXByaW1hcnkge1xyXG4gIHBhZGRpbmc6IDEwcHggMTVweDtcclxuICBib3JkZXI6IG5vbmU7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxuICBmb250LXdlaWdodDogYm9sZDtcclxuICBiYWNrZ3JvdW5kOiAjY2MwMTAxO1xyXG4gIGNvbG9yOiB3aGl0ZTtcclxuICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMnM7XHJcbn1cclxuXHJcbi5mb3JtLWNvbnRhaW5lciAuYnRuLXByaW1hcnk6ZGlzYWJsZWQge1xyXG4gIGJhY2tncm91bmQ6ICNjY2M7XHJcbiAgY3Vyc29yOiBub3QtYWxsb3dlZDtcclxufVxyXG5cclxuLmZvcm0tY29udGFpbmVyIC5idG4tcHJpbWFyeTpob3ZlcjplbmFibGVkIHtcclxuICBiYWNrZ3JvdW5kOiAjMWM3NDMyO1xyXG59XHJcblxyXG4uZm9ybS1jb250YWluZXIgLnJlZ3Jlc2FyIGEge1xyXG4gIGNvbG9yOiAjZmZmO1xyXG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxufVxyXG5cclxuLmZvcm0tY29udGFpbmVyIC5yZWdyZXNhciBhOmhvdmVyIHtcclxuICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n  return BookingComponent;\n})();","map":{"version":3,"names":["Validators","ReactiveFormsModule","CommonModule","BookingComponent","fb","bookingService","route","router","booking","actualuser","JSON","parse","localStorage","getItem","bookingForm","propertyId","constructor","group","listingId","required","pattern","startDate","endDate","totalPrice","min","ngOnInit","snapshot","paramMap","get","onSubmit","valid","value","console","error","currentUser","userId","user_id","bookingData","listing_id","parseInt","start_date","end_date","total_price","realizarReserva","subscribe","response","log","navigate","message","cancelarReserva","bookingId","submitget","obtenerReservasBuyer","push","print","reu","ObtenerReserva","i0","ɵɵdirectiveInject","i1","FormBuilder","i2","BookingService","i3","ActivatedRoute","Router","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","BookingComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵNgNoValidate","NgControlStatusGroup","styles"],"sources":["C:\\Users\\Nereida Ramos\\Downloads\\tercera_entrega_front\\src\\app\\features\\pages\\booking\\booking.component.ts","C:\\Users\\Nereida Ramos\\Downloads\\tercera_entrega_front\\src\\app\\features\\pages\\booking\\booking.component.html"],"sourcesContent":["  import { Component, OnInit } from '@angular/core';\r\n  import { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';\r\n  import { BookingService } from '../../../services/supabase/booking.service';\r\n  import { ActivatedRoute, Router, RouterLink } from '@angular/router';\r\n  import { CommonModule } from '@angular/common';\r\n  interface user {\r\n    isActive: boolean;\r\n    user_id: number;\r\n    email: string;  \r\n    profile_picture: string;  \r\n    is_owner: boolean;  \r\n    bio: string;  \r\n    created_at: string;  \r\n    updated_at: string;  \r\n    deleted_at: string;  \r\n  }\r\n  interface book {\r\n  Isread: boolean,\r\n  booking_id: number,\r\n  created_at: string,\r\n  deleted_at: string,\r\n  end_date: string,\r\n  start_date: string,\r\n  total_price: number,\r\n  updated_at: string\r\n}\r\n  @Component({\r\n    selector: 'app-booking',\r\n    standalone: true,\r\n    imports: [ReactiveFormsModule, CommonModule,RouterLink],\r\n    templateUrl: './booking.component.html',\r\n    styleUrls: ['./booking.component.css']\r\n  })\r\n  export class BookingComponent implements OnInit {\r\n    booking:any=[]\r\n    actualuser:user|null = JSON.parse(localStorage.getItem('user')!);\r\n\r\n    bookingForm: FormGroup;\r\n    propertyId: string = '';\r\n\r\n    constructor(\r\n      private fb: FormBuilder,\r\n      private bookingService: BookingService,\r\n      private route: ActivatedRoute,\r\n      private router: Router\r\n    ) {\r\n      // Definir el formulario con los controles necesarios\r\n      this.bookingForm = this.fb.group({\r\n        listingId: ['', [Validators.required, Validators.pattern(/^\\d+$/)]],\r\n        startDate: ['', Validators.required],\r\n        endDate: ['', Validators.required],\r\n        totalPrice: ['', [Validators.required, Validators.min(0)]]\r\n      });\r\n    }\r\n\r\n    ngOnInit(): void {\r\n      // Obtener el ID de la propiedad desde la URL\r\n      this.propertyId = this.route.snapshot.paramMap.get('id') || '';\r\n    }\r\n\r\n    // Método para realizar la reserva\r\n    onSubmit(): void {\r\n      if (this.bookingForm.valid) {\r\n        // Obtener las fechas como cadenas en formato YYYY-MM-DD\r\n        const startDate = this.bookingForm.value.startDate;\r\n        const endDate = this.bookingForm.value.endDate;\r\n    \r\n        // Validar que las fechas no sean inválidas\r\n        if (!startDate || !endDate) {\r\n          console.error('Las fechas de inicio o fin son inválidas');\r\n          return;\r\n        }\r\n    \r\n        //aqui establecmos un precio pr defecto para proba\r\n        const totalPrice = this.bookingForm.value.totalPrice || 56437;\r\n    \r\n        // Obtener el user_id del localStorage (asegúrate que el usuario esté autenticado)\r\n        const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\r\n        const userId = currentUser?.user_id;\r\n    \r\n        // Validar que se obtuvo el user_id\r\n        if (!userId) {\r\n          console.error('No se pudo obtener el user_id del usuario');\r\n          return;\r\n        }\r\n\r\n        // Preparar los datos de la reserva, asegurándose de que las fechas estén en formato correcto\r\n        const bookingData = {\r\n          listing_id: parseInt(this.bookingForm.value.listingId, 10),\r\n          user_id: userId,  \r\n          start_date: startDate,  \r\n          end_date: endDate,  \r\n          total_price: totalPrice\r\n        };\r\n    \r\n        // Llamar al servicio para realizar la reserva\r\n        this.bookingService.realizarReserva(bookingData).subscribe(response => {\r\n          console.log('Reserva realizada con éxito', response);\r\n          this.router.navigate(['/property-list']);  \r\n        }, error => {\r\n          console.error('Error al realizar la reserva', error);\r\n          if (error.error && error.error.message) {\r\n            console.error('Errores específicos:', error.error.message);\r\n          }\r\n        });\r\n      } else {\r\n        console.error('Formulario inválido');\r\n      }\r\n    }\r\n\r\n    // Método para cancelar una reserva\r\n    cancelarReserva(bookingId: number): void {\r\n      this.bookingService.cancelarReserva(bookingId).subscribe(response => {\r\n        console.log('Reserva cancelada', response);\r\n        \r\n      }, error => {\r\n        console.error('Error al cancelar la reserva', error);\r\n      });\r\n    }\r\n  submitget(){\r\n    this.bookingService.obtenerReservasBuyer(this.actualuser!.user_id).subscribe(response => {\r\n      console.log('Reserva cancelada', response);\r\n      this.booking.push(response)\r\n      \r\n    }, error => {\r\n      console.error('Error al cancelar la reserva', error);\r\n    });\r\n}\r\nprint(reu:any){\r\n  console.log(reu);\r\n  \r\n}\r\n  ObtenerReserva(bookingId: string): void {\r\n      console.log(\"w\");\r\n\r\n    }\r\n  }\r\n","<body>\r\n  <div class=\"main-container\">\r\n    <!-- Contenedor de Reservas -->\r\n    <div class=\"reservations-container\">\r\n      <h1>Reservas</h1>\r\n      <ul class=\"reservations-list\">\r\n        <li class=\"reservation-item\">\r\n          <div class=\"reservation-details\">\r\n            <p>Reserva 1</p>\r\n          </div>\r\n          <div class=\"reservation-actions\">\r\n            <button class=\"btn\">Eliminar</button>\r\n          </div>\r\n        </li>\r\n        <li class=\"reservation-item\">\r\n          <div class=\"reservation-details\">\r\n            <p>Reserva 2</p>\r\n          </div>\r\n          <div class=\"reservation-actions\">\r\n            <button class=\"btn\">Eliminar</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <!-- Contenedor del Formulario -->\r\n    <div class=\"form-container\">\r\n      <h2>Formulario</h2>\r\n      <form>\r\n        <label for=\"name\">Nombre</label>\r\n        <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"Introduce tu nombre\">\r\n        <label for=\"email\">Email</label>\r\n        <input type=\"email\" id=\"email\" name=\"email\" placeholder=\"Introduce tu email\">\r\n        <button type=\"submit\" class=\"btn-primary\">Enviar</button>\r\n        <div class=\"regresar\">\r\n          <a href=\"#\">Regresar</a>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</body>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}